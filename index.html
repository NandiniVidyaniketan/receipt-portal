<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Fee Receipt System</title>
    <style>
/* ========================================
   MODERN SCHOOL FEE RECEIPT PORTAL
   Professional Premium Design
   ======================================== */

/* ========== GLOBAL RESET & IMPORTS ========== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    /* Premium School Color Palette */
    --primary-navy: #1e3a8a;
    --primary-royal: #2563eb;
    --primary-light: #3b82f6;
    --accent-teal: #0d9488;
    --accent-gold: #f59e0b;
    
    /* Neutral Colors */
    --white: #ffffff;
    --gray-50: #f9fafb;
    --gray-100: #f3f4f6;
    --gray-200: #e5e7eb;
    --gray-300: #d1d5db;
    --gray-400: #9ca3af;
    --gray-500: #6b7280;
    --gray-600: #4b5563;
    --gray-700: #374151;
    --gray-800: #1f2937;
    --gray-900: #111827;
    
    /* Gradients */
    --gradient-primary: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%);
    --gradient-success: linear-gradient(135deg, #059669 0%, #10b981 100%);
    --gradient-warning: linear-gradient(135deg, #d97706 0%, #f59e0b 100%);
    
    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    
    /* Border Radius */
    --radius-sm: 6px;
    --radius-md: 10px;
    --radius-lg: 16px;
    --radius-xl: 20px;
}

body {
    font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #e0e7ff 0%, #f0f9ff 100%);
    min-height: 100vh;
    padding: 20px;
    color: var(--gray-800);
    line-height: 1.6;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    background: var(--white);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-xl);
    overflow: hidden;
}

/* ========== SCHOOL HEADER (ABSOLUTE TOP) ========== */
.school-header {
    background: var(--gradient-primary);
    color: var(--white);
    padding: 20px 40px;
    border-bottom: 4px solid var(--accent-gold);
}

.school-header-content {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 25px;
    align-items: center;
    max-width: 1400px;
    margin: 0 auto;
}

.school-logo-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
}

.school-logo-main {
    width: 90px;
    height: 90px;
    object-fit: contain;
    background: var(--white);
    padding: 6px;
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-lg);
}

.school-info {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.school-name {
    font-size: 2em;
    font-weight: 700;
    margin: 0;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
    letter-spacing: 0.5px;
    line-height: 1.2;
}

.school-address {
    font-size: 0.95em;
    opacity: 0.95;
    font-weight: 300;
    margin: 0;
    line-height: 1.4;
}

.school-contact-info {
    display: flex;
    gap: 20px;
    margin-top: 6px;
    flex-wrap: wrap;
}

.contact-item {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 255, 255, 0.15);
    padding: 5px 12px;
    border-radius: var(--radius-sm);
    backdrop-filter: blur(10px);
}

.contact-item svg {
    flex-shrink: 0;
}

.inline-input {
    background: transparent;
    border: none;
    color: var(--white);
    font-size: 0.9em;
    font-family: inherit;
    outline: none;
    width: 180px;
}

.inline-input::placeholder {
    color: rgba(255, 255, 255, 0.7);
}

/* ========== FORM SECTION ========== */
.form-section {
    padding: 30px 40px;
    background: var(--gray-50);
}

/* ========== FORM CARDS ========== */
.form-card {
    background: var(--white);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-md);
    margin-bottom: 25px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.form-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.card-header {
    background: var(--gradient-primary);
    color: var(--white);
    padding: 18px 25px;
    display: flex;
    align-items: center;
    gap: 12px;
}

.card-header h2 {
    font-size: 1.25em;
    font-weight: 600;
    margin: 0;
}

.card-header svg {
    flex-shrink: 0;
}

.card-body {
    padding: 25px;
}

/* ========== FORM ELEMENTS ========== */
.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.form-group label {
    font-weight: 500;
    color: var(--gray-700);
    font-size: 0.9em;
}

.required {
    color: #ef4444;
    font-weight: 600;
}

.form-group input,
.form-group select {
    padding: 12px 16px;
    border: 2px solid var(--gray-200);
    border-radius: var(--radius-md);
    font-size: 0.95em;
    font-family: inherit;
    transition: all 0.3s ease;
    background: var(--white);
}

.form-group input:focus,
.form-group select:focus {
    outline: none;
    border-color: var(--primary-royal);
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.form-group input:read-only {
    background: var(--gray-100);
    cursor: not-allowed;
}

.help-text {
    font-size: 0.8em;
    color: var(--gray-500);
    margin-top: 4px;
}

/* ========== PHOTO UPLOAD ========== */
.photo-section {
    margin-top: 25px;
    padding-top: 25px;
    border-top: 2px solid var(--gray-100);
}

.photo-section > label {
    font-weight: 500;
    color: var(--gray-700);
    font-size: 0.9em;
    display: block;
    margin-bottom: 12px;
}

.photo-upload-area {
    display: flex;
    align-items: center;
    gap: 20px;
}

.photo-preview {
    width: 140px;
    height: 160px;
    border: 3px dashed var(--gray-300);
    border-radius: var(--radius-md);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 8px;
    overflow: hidden;
    background: var(--gray-50);
    transition: all 0.3s ease;
}

.photo-preview:hover {
    border-color: var(--primary-royal);
    background: var(--gray-100);
}

.photo-preview img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.photo-preview svg {
    color: var(--gray-400);
}

.photo-text {
    color: var(--gray-500);
    font-size: 0.85em;
    text-align: center;
}

.btn-upload {
    background: var(--gradient-primary);
    color: var(--white);
    border: none;
    padding: 12px 24px;
    border-radius: var(--radius-md);
    font-size: 0.95em;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
    font-family: inherit;
}

.btn-upload:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

/* ========== FEE TABLE ========== */
.table-responsive {
    overflow-x: auto;
}

.fee-table {
    width: 100%;
    border-collapse: collapse;
    background: var(--white);
}

.fee-table thead {
    background: var(--gradient-primary);
    color: var(--white);
}

.fee-table th {
    padding: 14px 16px;
    text-align: left;
    font-weight: 600;
    font-size: 0.9em;
    letter-spacing: 0.3px;
}

.fee-table td {
    padding: 12px 16px;
    border-bottom: 1px solid var(--gray-200);
}

.fee-table tr:hover {
    background: var(--gray-50);
}

.fee-table input,
.fee-table select {
    width: 100%;
    padding: 10px 12px;
    border: 2px solid var(--gray-200);
    border-radius: var(--radius-sm);
    font-size: 0.9em;
    font-family: inherit;
    transition: all 0.3s ease;
    background: var(--white);
}

.fee-table input:focus,
.fee-table select:focus {
    outline: none;
    border-color: var(--primary-royal);
    box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
    background: var(--white);
}

.btn-remove {
    background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
    color: var(--white);
    border: none;
    padding: 8px 16px;
    border-radius: var(--radius-sm);
    cursor: pointer;
    font-size: 0.85em;
    font-weight: 500;
    transition: all 0.3s ease;
    font-family: inherit;
}

.btn-remove:hover {
    transform: scale(1.05);
    box-shadow: var(--shadow-md);
}

.btn-add-row {
    background: var(--accent-teal);
    color: var(--white);
    border: none;
    padding: 12px 24px;
    border-radius: var(--radius-md);
    cursor: pointer;
    font-size: 0.95em;
    font-weight: 500;
    transition: all 0.3s ease;
    margin-top: 15px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-family: inherit;
}

.btn-add-row:hover {
    background: #0f766e;
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

/* ========== ACTION BUTTONS ========== */
.action-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
    padding: 15px 0 25px 0;
    flex-wrap: wrap;
}

.btn-generate,
.btn-print,
.btn-new {
    padding: 14px 32px;
    font-size: 1em;
    font-weight: 600;
    border: none;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: var(--shadow-md);
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: inherit;
    letter-spacing: 0.3px;
}

.btn-generate {
    background: var(--gradient-primary);
    color: var(--white);
}

.btn-generate:hover {
    transform: translateY(-3px);
    box-shadow: var(--shadow-lg);
}

.btn-print {
    background: var(--gradient-success);
    color: var(--white);
}

.btn-print:hover {
    transform: translateY(-3px);
    box-shadow: var(--shadow-lg);
}

.btn-new {
    background: var(--gradient-warning);
    color: var(--white);
}

.btn-new:hover {
    transform: translateY(-3px);
    box-shadow: var(--shadow-lg);
}

/* Export to Excel Button */
.btn-export {
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    color: var(--white);
    border: none;
    padding: 14px 24px;
    border-radius: var(--radius-md);
    cursor: pointer;
    font-size: 15px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 10px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(17, 153, 142, 0.3);
    font-family: inherit;
}

.btn-export:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(17, 153, 142, 0.4);
}

.btn-export:active {
    transform: translateY(0);
}

.btn-export svg {
    flex-shrink: 0;
}

/* ========== RECEIPT PREVIEW ========== */
.receipt-preview {
    display: none;
    max-width: 900px;
    margin: 40px auto;
    background: var(--white);
    padding: 25px;
    border: 3px solid var(--gray-800);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-xl);
}

.receipt-preview.active {
    display: block;
    animation: fadeIn 0.5s ease;
}

.receipt-header {
    text-align: center;
    border-bottom: 3px double var(--gray-800);
    padding-bottom: 12px;
    margin-bottom: 12px;
}

.receipt-logo {
    width: 70px;
    height: 70px;
    object-fit: contain;
    margin-bottom: 8px;
}

.receipt-school-name {
    font-size: 1.6em;
    font-weight: 700;
    color: var(--primary-navy);
    margin-bottom: 5px;
}

.receipt-school-address {
    color: var(--gray-600);
    font-size: 0.85em;
    margin-bottom: 3px;
}

.receipt-school-contact {
    color: var(--gray-600);
    font-size: 0.8em;
    margin-bottom: 6px;
}

.receipt-title {
    font-size: 1.5em;
    font-weight: 700;
    color: var(--primary-royal);
    margin-top: 8px;
    text-decoration: underline;
    text-decoration-thickness: 2px;
    text-underline-offset: 4px;
}

.receipt-meta {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin-bottom: 12px;
    padding: 10px;
    background: var(--gray-50);
    border-radius: var(--radius-sm);
    border: 1px solid var(--gray-200);
    font-size: 0.9em;
}

.receipt-student-section {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 15px;
    margin-bottom: 12px;
    padding: 12px;
    border: 2px solid var(--gray-300);
    border-radius: var(--radius-sm);
    background: var(--gray-50);
}

.receipt-student-details {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 6px;
}

.detail-row {
    display: flex;
    padding: 3px 0;
}

.detail-label {
    font-weight: 600;
    color: var(--gray-700);
    min-width: 140px;
    font-size: 0.85em;
}

.detail-value {
    color: var(--gray-900);
    font-size: 0.85em;
}

.receipt-student-photo {
    width: 120px;
    height: 140px;
    border: 2px solid var(--gray-800);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    background: var(--white);
}

.receipt-student-photo img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.receipt-fee-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 10px;
}

.receipt-fee-table th,
.receipt-fee-table td {
    border: 1px solid var(--gray-800);
    padding: 8px 10px;
    text-align: left;
}

.receipt-fee-table th {
    background: var(--gray-100);
    font-weight: 600;
    color: var(--gray-800);
    font-size: 0.85em;
}

.receipt-fee-table .total-row {
    font-weight: 700;
    background: var(--gray-50);
    font-size: 1em;
}

.amount-in-words {
    font-style: italic;
    color: var(--gray-700);
    padding: 8px 10px;
    background: #fef3c7;
    border-left: 4px solid var(--accent-gold);
    border-radius: var(--radius-sm);
    margin-bottom: 10px;
    font-size: 0.85em;
}

.receipt-payment-info {
    margin-bottom: 12px;
    padding: 10px;
    background: var(--gray-50);
    border-radius: var(--radius-sm);
    border: 1px solid var(--gray-200);
    font-size: 0.9em;
}

.receipt-footer {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-top: 20px;
    padding-top: 15px;
    border-top: 2px solid var(--gray-300);
}

.signature-box {
    text-align: center;
}

.signature-line {
    border-top: 2px solid var(--gray-800);
    margin-top: 40px;
    padding-top: 5px;
    font-size: 0.8em;
    font-weight: 500;
    color: var(--gray-700);
}

.stamp-box {
    border: 2px dashed var(--gray-400);
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--gray-500);
    margin-bottom: 5px;
    font-size: 0.8em;
    border-radius: var(--radius-sm);
}

/* ========== ANIMATIONS ========== */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ========== PRINT STYLES ========== */
@media print {
    @page {
        size: A4;
        margin: 10mm;
    }

    body {
        background: var(--white);
        padding: 0;
        margin: 0;
    }

    .container {
        box-shadow: none;
        border-radius: 0;
    }

    .school-header,
    .form-section,
    .action-buttons {
        display: none !important;
    }

    .receipt-preview {
        display: block !important;
        border: 2px solid var(--gray-800);
        box-shadow: none;
        margin: 0;
        padding: 15px;
        page-break-inside: avoid;
    }

    .receipt-header {
        padding-bottom: 8px;
        margin-bottom: 8px;
    }

    .receipt-logo {
        width: 60px;
        height: 60px;
        margin-bottom: 5px;
    }

    .receipt-school-name {
        font-size: 1.4em;
        margin-bottom: 3px;
    }

    .receipt-school-address {
        font-size: 0.8em;
        margin-bottom: 2px;
    }

    .receipt-school-contact {
        font-size: 0.75em;
        margin-bottom: 4px;
    }

    .receipt-title {
        font-size: 1.3em;
        margin-top: 5px;
    }

    .receipt-meta {
        padding: 8px;
        margin-bottom: 10px;
        font-size: 0.85em;
    }

    .receipt-student-section {
        padding: 10px;
        margin-bottom: 10px;
        gap: 12px;
    }

    .receipt-student-details {
        gap: 4px;
    }

    .detail-row {
        padding: 2px 0;
    }

    .detail-label,
    .detail-value {
        font-size: 0.8em;
    }

    .receipt-student-photo {
        width: 100px;
        height: 120px;
    }

    .receipt-fee-table {
        margin-bottom: 8px;
    }

    .receipt-fee-table th,
    .receipt-fee-table td {
        padding: 6px 8px;
        font-size: 0.8em;
    }

    .amount-in-words {
        padding: 6px 8px;
        margin-bottom: 8px;
        font-size: 0.8em;
    }

    .receipt-payment-info {
        padding: 8px;
        margin-bottom: 10px;
        font-size: 0.85em;
    }

    .receipt-footer {
        margin-top: 15px;
        padding-top: 10px;
        gap: 12px;
    }

    .signature-line {
        margin-top: 35px;
        padding-top: 4px;
        font-size: 0.75em;
    }

    .stamp-box {
        height: 50px;
        font-size: 0.75em;
        margin-bottom: 3px;
    }
}

/* ========== RESPONSIVE DESIGN ========== */
@media (max-width: 1024px) {
    .container {
        margin: 10px;
    }

    .form-section {
        padding: 30px 20px;
    }

    .card-body {
        padding: 25px 20px;
    }
}

@media (max-width: 768px) {
    body {
        padding: 10px;
    }

    .school-header {
        padding: 25px 20px;
    }

    .school-header-content {
        grid-template-columns: 1fr;
        text-align: center;
        gap: 20px;
    }

    .school-logo-main {
        margin: 0 auto;
    }

    .school-contact-info {
        justify-content: center;
    }

    .form-grid {
        grid-template-columns: 1fr;
    }

    .photo-upload-area {
        flex-direction: column;
    }

    .receipt-student-section {
        grid-template-columns: 1fr;
    }

    .receipt-student-details {
        grid-template-columns: 1fr;
    }

    .receipt-footer {
        grid-template-columns: 1fr;
    }

    .action-buttons {
        flex-direction: column;
        width: 100%;
    }

    .btn-generate,
    .btn-print,
    .btn-new {
        width: 100%;
        justify-content: center;
    }

    .receipt-meta {
        grid-template-columns: 1fr;
    }

    .receipt-preview {
        padding: 20px;
    }

    .school-name {
        font-size: 1.5em;
    }
}

@media (max-width: 480px) {
    .school-logo-main {
        width: 80px;
        height: 80px;
    }

    .school-name {
        font-size: 1.3em;
    }

    .card-header h2 {
        font-size: 1.1em;
    }

    .receipt-school-name {
        font-size: 1.5em;
    }

    .receipt-title {
        font-size: 1.4em;
    }
}

/* ========== SMOOTH TRANSITIONS ========== */
* {
    transition: background-color 0.3s ease, border-color 0.3s ease;
}

button,
input,
select {
    transition: all 0.3s ease;
}
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- SCHOOL HEADER (ABSOLUTE TOP) -->
        <div class="school-header">
            <div class="school-header-content">
                <div class="school-logo-wrapper">
                    <img src="https://drive.google.com/uc?export=download&id=1BmdHYGo4O90QBBb7zLSFr6nXe_kUipZ7" alt="School Logo" class="school-logo-main" id="schoolLogoMain">
                </div>
                <div class="school-info">
                    <h1 class="school-name">Nandini Vidyaniketan (E-Learning Vista Pvt. Ltd.)</h1>
                    <p class="school-address">Nandini Nagar, Rupaidiha Road, Nanpara (Bahraich), Uttar Pradesh</p>
                    <div class="school-contact-info">
                        <div class="contact-item">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                            </svg>
                            <input type="tel" id="schoolContact" placeholder="+91 XXXXX XXXXX" class="inline-input">
                        </div>
                        <div class="contact-item">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                                <polyline points="22,6 12,13 2,6"></polyline>
                            </svg>
                            <input type="email" id="schoolEmail" placeholder="school@example.com" class="inline-input">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MAIN FORM SECTION -->
        <div class="form-section">
            <!-- RECEIPT INFORMATION CARD -->
            <div class="form-card">
                <div class="card-header">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    <h2>Receipt Information</h2>
                </div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="receiptNumber">Receipt Number</label>
                            <input type="text" id="receiptNumber" readonly>
                            <small class="help-text">Auto-generated (NVA001-NVA999, then NVB001...)</small>
                        </div>
                        <div class="form-group">
                            <label for="receiptDate">Receipt Date</label>
                            <input type="date" id="receiptDate">
                        </div>
                        <div class="form-group">
                            <label for="academicSession">Academic Session <span class="required">*</span></label>
                            <input type="text" id="academicSession" placeholder="e.g., 2024-2025" required>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STUDENT INFORMATION CARD -->
            <div class="form-card">
                <div class="card-header">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <h2>Student Information</h2>
                </div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="studentName">Student Name <span class="required">*</span></label>
                            <input type="text" id="studentName" placeholder="Enter student name" required>
                        </div>
                        <div class="form-group">
                            <label for="dob">Date of Birth</label>
                            <input type="date" id="dob">
                        </div>
                        <div class="form-group">
                            <label for="gender">Gender</label>
                            <select id="gender">
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="fatherName">Father's Name</label>
                            <input type="text" id="fatherName" placeholder="Enter father's name">
                        </div>
                        <div class="form-group">
                            <label for="motherName">Mother's Name</label>
                            <input type="text" id="motherName" placeholder="Enter mother's name">
                        </div>
                        <div class="form-group">
                            <label for="classSection">Class / Section <span class="required">*</span></label>
                            <input type="text" id="classSection" placeholder="e.g., 10-A" required>
                        </div>
                    </div>

                    <div class="photo-section">
                        <label>Student Photo (Optional)</label>
                        <div class="photo-upload-area">
                            <div class="photo-preview" id="studentPhotoPreview">
                                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                </svg>
                                <span class="photo-text">Student Photo</span>
                            </div>
                            <input type="file" id="studentPhoto" accept="image/*" hidden>
                            <button type="button" class="btn-upload" onclick="document.getElementById('studentPhoto').click()">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="17 8 12 3 7 8"></polyline>
                                    <line x1="12" y1="3" x2="12" y2="15"></line>
                                </svg>
                                Upload Photo
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FEE DETAILS CARD -->
            <div class="form-card">
                <div class="card-header">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="12"></line>
                        <line x1="12" y1="16" x2="12.01" y2="16"></line>
                    </svg>
                    <h2>Fee Details</h2>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="fee-table" id="feeTable">
                            <thead>
                                <tr>
                                    <th>Fee Type</th>
                                    <th>Month / Period</th>
                                    <th>Amount (‚Çπ)</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="feeTableBody">
                                <tr>
                                    <td>
                                        <select class="fee-type">
                                            <option value="">Select Type</option>
                                            <option value="Admission Fee">Admission Fee</option>
                                            <option value="Tuition Fee">Tuition Fee</option>
                                            <option value="Exam Fee">Exam Fee</option>
                                            <option value="Transport Fee">Transport Fee</option>
                                            <option value="Hostel Fee">Hostel Fee</option>
                                            <option value="Library Fee">Library Fee</option>
                                            <option value="Lab Fee">Lab Fee</option>
                                            <option value="Sports Fee">Sports Fee</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </td>
                                    <td><input type="text" class="fee-period" placeholder="e.g., January 2025"></td>
                                    <td><input type="number" class="fee-amount" placeholder="0" min="0" step="0.01"></td>
                                    <td><button class="btn-remove" onclick="removeRow(this)">Remove</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <button class="btn-add-row" onclick="addFeeRow()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Add Fee Row
                    </button>
                </div>
            </div>

            <!-- PAYMENT INFORMATION CARD -->
            <div class="form-card">
                <div class="card-header">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                        <line x1="1" y1="10" x2="23" y2="10"></line>
                    </svg>
                    <h2>Payment Information</h2>
                </div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="paymentMode">Payment Mode <span class="required">*</span></label>
                            <select id="paymentMode" required>
                                <option value="">Select Payment Mode</option>
                                <option value="Cash">Cash</option>
                                <option value="Online Transfer">Online Transfer</option>
                                <option value="Cheque">Cheque</option>
                                <option value="Demand Draft">Demand Draft</option>
                                <option value="UPI">UPI</option>
                                <option value="Card">Card</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="transactionId">Transaction ID / Cheque Number</label>
                            <input type="text" id="transactionId" placeholder="Enter transaction ID or cheque number">
                        </div>
                        <div class="form-group">
                            <label for="paymentDate">Payment Date</label>
                            <input type="date" id="paymentDate">
                        </div>
                    </div>
                </div>
            </div>

            <!-- ACTION BUTTONS -->
            <div class="action-buttons">
                <button class="btn-generate" onclick="generateReceipt()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    Generate Receipt
                </button>
                
                <!-- NEW: Export to Excel Button -->
                
                <button class="btn-print" onclick="printReceipt()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 6 2 18 2 18 9"></polyline>
                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                        <rect x="6" y="14" width="12" height="8"></rect>
                    </svg>
                    Print Receipt
                </button>
                <button class="btn-new" onclick="resetForm()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="1 4 1 10 7 10"></polyline>
                        <polyline points="23 20 23 14 17 14"></polyline>
                        <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
                    </svg>
                    New Receipt
                </button>
            </div>
        </div>

        <!-- RECEIPT PREVIEW -->
        <div class="receipt-preview" id="receiptPreview">
            <div class="receipt-header">
                <img id="receiptLogo" class="receipt-logo" style="display: none;">
                <div class="receipt-school-name" id="receiptSchoolName"></div>
                <div class="receipt-school-address" id="receiptSchoolAddress"></div>
                <div class="receipt-school-contact" id="receiptSchoolContact"></div>
                <div class="receipt-title">FEE RECEIPT</div>
            </div>

            <div class="receipt-meta">
                <div><strong>Receipt No:</strong> <span id="receiptNo"></span></div>
                <div><strong>Date:</strong> <span id="receiptDateDisplay"></span></div>
                <div><strong>Session:</strong> <span id="receiptSession"></span></div>
            </div>

            <div class="receipt-student-section">
                <div class="receipt-student-details">
                    <div class="detail-row">
                        <span class="detail-label">Student Name:</span>
                        <span class="detail-value" id="receiptStudentName"></span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Date of Birth:</span>
                        <span class="detail-value" id="receiptDob"></span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Gender:</span>
                        <span class="detail-value" id="receiptGender"></span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Father's Name:</span>
                        <span class="detail-value" id="receiptFatherName"></span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Mother's Name:</span>
                        <span class="detail-value" id="receiptMotherName"></span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Class / Section:</span>
                        <span class="detail-value" id="receiptClass"></span>
                    </div>
                </div>
                <div class="receipt-student-photo" id="receiptStudentPhotoContainer" style="display: none;">
                    <img id="receiptStudentPhoto">
                </div>
            </div>

            <table class="receipt-fee-table">
                <thead>
                    <tr>
                        <th>S.No</th>
                        <th>Fee Type</th>
                        <th>Month / Period</th>
                        <th>Amount (‚Çπ)</th>
                    </tr>
                </thead>
                <tbody id="receiptFeeTableBody">
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="3" style="text-align: right;"><strong>Total Amount:</strong></td>
                        <td><strong>‚Çπ <span id="receiptTotal">0.00</span></strong></td>
                    </tr>
                </tfoot>
            </table>

            <div class="amount-in-words">
                <strong>Amount in Words:</strong> <span id="amountInWords"></span>
            </div>

            <div class="receipt-payment-info">
                <div class="detail-row">
                    <span class="detail-label">Payment Mode:</span>
                    <span class="detail-value" id="receiptPaymentMode"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Transaction ID / Cheque No:</span>
                    <span class="detail-value" id="receiptTransactionId"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Payment Date:</span>
                    <span class="detail-value" id="receiptPaymentDate"></span>
                </div>
            </div>

            <div class="receipt-footer">
                <div class="signature-box">
                    <div class="stamp-box">School Stamp</div>
                    <div class="signature-line">Authorized Signature</div>
                </div>
                <div class="signature-box">
                    <div class="signature-line" style="margin-top: 80px;">Cashier Signature</div>
                </div>
                <div class="signature-box">
                    <div class="signature-line" style="margin-top: 80px;">Parent Signature</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add SheetJS library for Excel export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
// ========================================
//    FEE RECEIPT PORTAL - JAVASCRIPT
//    (GOOGLE DRIVE VERSION - AUTO RECEIPT NUMBER)
// ========================================

// ========== GOOGLE APPS SCRIPT CONFIGURATION ==========
/**
 * ‚ö†Ô∏è CRITICAL: Replace this with YOUR Google Apps Script Web App URL
 * 
 * This is the SAME URL you used before
 * Example: https://script.google.com/macros/s/AKfycby.../exec
 */
const GOOGLE_SCRIPT_URL = 'PASTE_YOUR_WEB_APP_URL_HERE';

// ========== INITIALIZE ON PAGE LOAD ==========
window.onload = function() {
    // Fetch the next receipt number from Google Sheets
    fetchNextReceiptNumber();
    setCurrentDate();
    attachEventListeners();
};

// ========== FETCH NEXT RECEIPT NUMBER FROM GOOGLE SHEETS ==========
/**
 * Fetches the next receipt number from Google Sheets automatically
 * This ensures no duplicate receipt numbers across different computers
 */
function fetchNextReceiptNumber() {
    console.log('üìã Fetching next receipt number from Google Sheets...');
    
    // Check if URL is configured
    if (GOOGLE_SCRIPT_URL === 'PASTE_YOUR_WEB_APP_URL_HERE') {
        console.error('‚ùå Google Apps Script URL not configured!');
        document.getElementById('receiptNumber').value = 'NVA001';
        return;
    }
    
    // Show loading state
    const receiptNumberField = document.getElementById('receiptNumber');
    receiptNumberField.value = 'Loading...';
    
    // Fetch next receipt number from Google Sheets
    fetch(GOOGLE_SCRIPT_URL + '?action=getNextReceipt')
        .then(response => response.json())
        .then(data => {
            console.log('‚úÖ Response from Google Sheets:', data);
            
            if (data.status === 'success' && data.nextReceiptNumber) {
                receiptNumberField.value = data.nextReceiptNumber;
                console.log('‚úÖ Next receipt number:', data.nextReceiptNumber);
            } else {
                // Fallback to NVA001 if something goes wrong
                receiptNumberField.value = 'NVA001';
                console.warn('‚ö†Ô∏è Could not fetch receipt number, using NVA001');
            }
        })
        .catch(error => {
            console.error('‚ùå Error fetching receipt number:', error);
            // Fallback to NVA001
            receiptNumberField.value = 'NVA001';
        });
}

// ========== SET CURRENT DATE ==========
function setCurrentDate() {
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('receiptDate').value = today;
    document.getElementById('paymentDate').value = today;
}

// ========== ATTACH EVENT LISTENERS ==========
function attachEventListeners() {
    document.getElementById('studentPhoto').addEventListener('change', function(e) {
        previewImage(e, 'studentPhotoPreview');
    });
    attachAmountListeners();
}

// ========== IMAGE PREVIEW HANDLER ==========
function previewImage(event, previewId) {
    const file = event.target.files[0];
    const preview = document.getElementById(previewId);
    
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
        };
        reader.readAsDataURL(file);
    }
}

// ========== FEE TABLE MANAGEMENT ==========
function addFeeRow() {
    const tbody = document.getElementById('feeTableBody');
    const newRow = tbody.rows[0].cloneNode(true);
    
    const inputs = newRow.querySelectorAll('input');
    inputs.forEach(input => input.value = '');
    
    const select = newRow.querySelector('select');
    select.selectedIndex = 0;
    
    tbody.appendChild(newRow);
    attachAmountListeners();
}

function removeRow(button) {
    const tbody = document.getElementById('feeTableBody');
    if (tbody.rows.length > 1) {
        button.closest('tr').remove();
        calculateTotal();
    } else {
        alert('At least one fee row is required!');
    }
}

function attachAmountListeners() {
    const amounts = document.querySelectorAll('.fee-amount');
    amounts.forEach(input => {
        input.removeEventListener('input', calculateTotal);
        input.addEventListener('input', calculateTotal);
    });
}

function calculateTotal() {
    const amounts = document.querySelectorAll('.fee-amount');
    let total = 0;
    amounts.forEach(input => {
        const value = parseFloat(input.value) || 0;
        total += value;
    });
    return total;
}

// ========== NUMBER TO WORDS CONVERSION ==========
function numberToWords(num) {
    if (num === 0) return 'Zero';
    
    const ones = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine'];
    const tens = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
    const teens = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];
    
    function convertLessThanThousand(n) {
        if (n === 0) return '';
        if (n < 10) return ones[n];
        if (n < 20) return teens[n - 10];
        if (n < 100) return tens[Math.floor(n / 10)] + (n % 10 !== 0 ? ' ' + ones[n % 10] : '');
        return ones[Math.floor(n / 100)] + ' Hundred' + (n % 100 !== 0 ? ' ' + convertLessThanThousand(n % 100) : '');
    }
    
    if (num < 1000) return convertLessThanThousand(num);
    if (num < 100000) {
        const thousands = Math.floor(num / 1000);
        const remainder = num % 1000;
        return convertLessThanThousand(thousands) + ' Thousand' + (remainder !== 0 ? ' ' + convertLessThanThousand(remainder) : '');
    }
    if (num < 10000000) {
        const lakhs = Math.floor(num / 100000);
        const remainder = num % 100000;
        return convertLessThanThousand(lakhs) + ' Lakh' + (remainder !== 0 ? ' ' + numberToWords(remainder) : '');
    }
    
    const crores = Math.floor(num / 10000000);
    const remainder = num % 10000000;
    return convertLessThanThousand(crores) + ' Crore' + (remainder !== 0 ? ' ' + numberToWords(remainder) : '');
}

function formatDate(dateString) {
    if (!dateString) return 'N/A';
    const date = new Date(dateString);
    const day = String(date.getDate()).padStart(2, '0');
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const year = date.getFullYear();
    return `${day}/${month}/${year}`;
}

// ========== GENERATE RECEIPT ==========
function generateReceipt() {
    console.log('üéØ Generate Receipt clicked');
    
    // Validate required fields
    const studentName = document.getElementById('studentName').value.trim();
    const classSection = document.getElementById('classSection').value.trim();
    const academicSession = document.getElementById('academicSession').value.trim();
    const paymentMode = document.getElementById('paymentMode').value;

    if (!studentName) {
        alert('Please enter student name!');
        document.getElementById('studentName').focus();
        return;
    }
    if (!classSection) {
        alert('Please enter class/section!');
        document.getElementById('classSection').focus();
        return;
    }
    if (!academicSession) {
        alert('Please enter academic session!');
        document.getElementById('academicSession').focus();
        return;
    }
    if (!paymentMode) {
        alert('Please select payment mode!');
        document.getElementById('paymentMode').focus();
        return;
    }

    // Validate at least one fee entry
    const feeRows = document.querySelectorAll('#feeTableBody tr');
    let hasValidFee = false;
    feeRows.forEach(row => {
        const type = row.querySelector('.fee-type').value;
        const amount = parseFloat(row.querySelector('.fee-amount').value) || 0;
        if (type && amount > 0) hasValidFee = true;
    });

    if (!hasValidFee) {
        alert('Please add at least one fee entry with valid type and amount!');
        return;
    }

    // School information
    document.getElementById('receiptSchoolName').textContent = 'Nandini Vidyaniketan (E-Learning Vista Pvt. Ltd.)';
    document.getElementById('receiptSchoolAddress').textContent = 'Nandini Nagar, Rupaidiha Road, Nanpara (Bahraich), Uttar Pradesh';
    
    const contact = document.getElementById('schoolContact').value;
    let contactInfo = '';
    if (contact) contactInfo = 'Tel: ' + contact;
    document.getElementById('receiptSchoolContact').textContent = contactInfo;

    // School logo
    const receiptLogo = document.getElementById('receiptLogo');
    receiptLogo.src = 'https://drive.google.com/uc?export=download&id=1BmdHYGo4O90QBBb7zLSFr6nXe_kUipZ7';
    receiptLogo.style.display = 'block';

    // Receipt meta information
    document.getElementById('receiptNo').textContent = document.getElementById('receiptNumber').value;
    document.getElementById('receiptDateDisplay').textContent = formatDate(document.getElementById('receiptDate').value);
    document.getElementById('receiptSession').textContent = academicSession;

    // Student information
    document.getElementById('receiptStudentName').textContent = studentName;
    document.getElementById('receiptDob').textContent = formatDate(document.getElementById('dob').value);
    document.getElementById('receiptGender').textContent = document.getElementById('gender').value || 'N/A';
    document.getElementById('receiptFatherName').textContent = document.getElementById('fatherName').value || 'N/A';
    document.getElementById('receiptMotherName').textContent = document.getElementById('motherName').value || 'N/A';
    document.getElementById('receiptClass').textContent = classSection;

    // Student photo
    const photoPreview = document.getElementById('studentPhotoPreview').querySelector('img');
    const receiptPhoto = document.getElementById('receiptStudentPhoto');
    const photoContainer = document.getElementById('receiptStudentPhotoContainer');
    if (photoPreview) {
        receiptPhoto.src = photoPreview.src;
        photoContainer.style.display = 'flex';
    } else {
        photoContainer.style.display = 'none';
    }

    // Fee details table
    populateFeeTable();

    // Payment information
    document.getElementById('receiptPaymentMode').textContent = paymentMode;
    document.getElementById('receiptTransactionId').textContent = document.getElementById('transactionId').value || 'N/A';
    document.getElementById('receiptPaymentDate').textContent = formatDate(document.getElementById('paymentDate').value);

    // Show receipt preview
    document.getElementById('receiptPreview').classList.add('active');
    document.getElementById('receiptPreview').scrollIntoView({ behavior: 'smooth' });
    
    // Send data to Google Sheets
    sendDataToGoogleSheets();
}

// ========== POPULATE FEE TABLE IN RECEIPT ==========
function populateFeeTable() {
    const feeTableBody = document.getElementById('receiptFeeTableBody');
    feeTableBody.innerHTML = '';
    
    const feeRows = document.querySelectorAll('#feeTableBody tr');
    let total = 0;
    let serialNo = 1;
    
    feeRows.forEach(row => {
        const type = row.querySelector('.fee-type').value;
        const period = row.querySelector('.fee-period').value;
        const amount = parseFloat(row.querySelector('.fee-amount').value) || 0;
        
        if (type && amount > 0) {
            const newRow = feeTableBody.insertRow();
            newRow.innerHTML = `
                <td>${serialNo++}</td>
                <td>${type}</td>
                <td>${period || 'N/A'}</td>
                <td>‚Çπ ${amount.toFixed(2)}</td>
            `;
            total += amount;
        }
    });
    
    document.getElementById('receiptTotal').textContent = total.toFixed(2);
    document.getElementById('amountInWords').textContent = numberToWords(Math.floor(total)) + ' Rupees Only';
}

// ========== RESET FORM ==========
function resetForm() {
    if (confirm('Are you sure you want to create a new receipt? Current data will be cleared.')) {
        document.getElementById('studentName').value = '';
        document.getElementById('dob').value = '';
        document.getElementById('gender').value = '';
        document.getElementById('fatherName').value = '';
        document.getElementById('motherName').value = '';
        document.getElementById('classSection').value = '';
        document.getElementById('academicSession').value = '';
        document.getElementById('transactionId').value = '';
        document.getElementById('paymentMode').value = '';
        
        document.getElementById('studentPhoto').value = '';
        const photoPreview = document.getElementById('studentPhotoPreview');
        photoPreview.innerHTML = `
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span class="photo-text">Student Photo</span>
        `;
        
        const tbody = document.getElementById('feeTableBody');
        tbody.innerHTML = `
            <tr>
                <td>
                    <select class="fee-type">
                        <option value="">Select Type</option>
                        <option value="Admission Fee">Admission Fee</option>
                        <option value="Tuition Fee">Tuition Fee</option>
                        <option value="Exam Fee">Exam Fee</option>
                        <option value="Transport Fee">Transport Fee</option>
                        <option value="Hostel Fee">Hostel Fee</option>
                        <option value="Library Fee">Library Fee</option>
                        <option value="Lab Fee">Lab Fee</option>
                        <option value="Sports Fee">Sports Fee</option>
                        <option value="Other">Other</option>
                    </select>
                </td>
                <td><input type="text" class="fee-period" placeholder="e.g., January 2025"></td>
                <td><input type="number" class="fee-amount" placeholder="0" min="0" step="0.01"></td>
                <td><button class="btn-remove" onclick="removeRow(this)">Remove</button></td>
            </tr>
        `;
        
        attachAmountListeners();
        
        // Fetch next receipt number from Google Sheets
        fetchNextReceiptNumber();
        
        setCurrentDate();
        document.getElementById('receiptPreview').classList.remove('active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
}

// ========== PRINT RECEIPT ==========
function printReceipt() {
    const receiptPreview = document.getElementById('receiptPreview');
    if (!receiptPreview.classList.contains('active')) {
        alert('Please generate receipt first!');
        return;
    }
    window.print();
}

// ========== SEND DATA TO GOOGLE SHEETS ==========
function sendDataToGoogleSheets() {
    console.log('üì§ Sending data to Google Sheets...');
    
    if (GOOGLE_SCRIPT_URL === 'PASTE_YOUR_WEB_APP_URL_HERE') {
        console.error('‚ùå Google Apps Script URL not configured!');
        showNotification('‚ö†Ô∏è Google Sheets integration not configured', 'error');
        return;
    }

    const feeRows = document.querySelectorAll('#feeTableBody tr');
    const fees = [];

    feeRows.forEach(row => {
        const type = row.querySelector('.fee-type')?.value || '';
        const period = row.querySelector('.fee-period')?.value || '';
        const amount = parseFloat(row.querySelector('.fee-amount')?.value) || 0;

        if (type && amount > 0) {
            fees.push({ type, period, amount });
        }
    });

    const data = {
        receiptNumber: document.getElementById('receiptNumber').value,
        receiptDate: document.getElementById('receiptDate').value,
        academicSession: document.getElementById('academicSession').value,
        studentName: document.getElementById('studentName').value,
        dob: document.getElementById('dob').value,
        gender: document.getElementById('gender').value,
        fatherName: document.getElementById('fatherName').value,
        motherName: document.getElementById('motherName').value,
        classSection: document.getElementById('classSection').value,
        paymentMode: document.getElementById('paymentMode').value,
        transactionID: document.getElementById('transactionId').value,
        paymentDate: document.getElementById('paymentDate').value,
        fees: fees
    };

    console.log('üì¶ Data:', data);

    fetch(GOOGLE_SCRIPT_URL, {
        method: 'POST',
        redirect: 'follow',
        headers: {
            'Content-Type': 'text/plain;charset=utf-8',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.text())
    .then(text => {
        console.log('‚úÖ Response:', text);
        try {
            const jsonResponse = JSON.parse(text);
            if (jsonResponse.status === 'success') {
                showNotification('‚úÖ Receipt saved to Google Sheets!', 'success');
                
                // After successful save, fetch the next receipt number for the next receipt
                setTimeout(() => {
                    fetchNextReceiptNumber();
                }, 1000);
            } else {
                showNotification('‚ùå Error: ' + jsonResponse.message, 'error');
            }
        } catch (e) {
            showNotification('‚úÖ Receipt sent to Google Sheets', 'success');
            setTimeout(() => {
                fetchNextReceiptNumber();
            }, 1000);
        }
    })
    .catch(error => {
        console.error('‚ùå Error:', error);
        showNotification('‚ùå Failed to save to Google Sheets', 'error');
    });
}

// ========== NOTIFICATION SYSTEM ==========
function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.textContent = message;
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 25px;
        background: ${type === 'success' ? '#4CAF50' : '#f44336'};
        color: white;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 10000;
        font-weight: 500;
        animation: slideIn 0.3s ease-out;
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease-out';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}

// Add CSS animation
const style = document.createElement('style');
style.textContent = `
    @keyframes slideIn {
        from { transform: translateX(400px); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(400px); opacity: 0; }
    }
`;
document.head.appendChild(style);

    </script>
</body>
</html>
